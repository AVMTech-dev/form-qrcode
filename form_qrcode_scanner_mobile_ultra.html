
<!DOCTYPE html>

<html lang="it">
<head>
<meta charset="utf-8"/>
<title>FORM QRCODE - Scansione Seriali</title>
<script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
<style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #reader { width: 300px; margin-bottom: 20px; }
        #result { font-size: 1.2em; margin-bottom: 20px; }
        button { padding: 10px 20px; margin: 5px; font-size: 1em; }
    </style>
<style>
body {
    font-family: Arial, sans-serif;
    font-size: 18px;
    padding: 20px;
    margin: 0;
    background-color: #f9f9f9;
}
h1 {
    font-size: 24px;
    text-align: center;
    margin-bottom: 20px;
}
#reader {
    width: 100% !important;
    max-width: 400px;
    margin: 0 auto 20px auto;
}
#result {
    font-size: 20px;
    text-align: center;
    margin-bottom: 20px;
}
button {
    display: block;
    width: 100%;
    max-width: 300px;
    margin: 10px auto;
    padding: 15px;
    font-size: 20px;
    background-color: #0078d4;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}
button:hover {
    background-color: #005a9e;
}
@media screen and (max-width: 600px) {
    body {
        font-size: 20px;
    }
    h1 {
        font-size: 26px;
    }
    button {
        font-size: 22px;
        padding: 18px;
    }
}
</style><style>
body {
    font-size: 8rem;
    padding: 2rem;
    text-align: center;
}
button {
    font-size: 3rem;
    padding: 2rem 4rem;
    margin: 2rem;
    width: 100%;
    max-width: 600px;
}
#reader {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    margin: 2rem auto;
}
h1, h2, h3 {
    font-size: 10rem;
}
</style></head>
<body>
<h2>Scansiona il QR Code</h2>
<div id="reader"></div>
<div id="result">Seriale rilevato: <span id="seriale">--</span></div>
<button onclick="inviaSeriale('nuovo')">Seriale NUOVO</button>
<button onclick="inviaSeriale('rimosso')">Seriale RIMOSSO</button>
<script>
        let serialeRilevato = "";

        function onScanSuccess(decodedText, decodedResult) {
            serialeRilevato = decodedText;
            document.getElementById("seriale").innerText = serialeRilevato;
            html5QrcodeScanner.clear();
        }

        const html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", { fps: 10, qrbox: 250 });
        html5QrcodeScanner.render(onScanSuccess);

        function inviaSeriale(tipo) {
            if (!serialeRilevato) {
                alert("Scansiona prima un QR code.");
                return;
            }

            const baseUrl = "https://forms.office.com/Pages/ResponsePage.aspx?id=ZsJ8uMQJzECN-skuCL-ctJp3ZCXLhA5Eoq0lg0h-LxxUMVhRR1VGOVYzU0lMMVYzSzlXQlVNTDNXOS4u";
            let params = new URLSearchParams();

            if (tipo === "nuovo") {
                params.append("34_NSerialeApparatoNuovo", serialeRilevato);
            } else if (tipo === "rimosso") {
                params.append("35_NSerialeApparatoRimosso", serialeRilevato);
            }

            window.location.href = baseUrl + "&" + params.toString();
        }
    </script>
</body>
</html>
